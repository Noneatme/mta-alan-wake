--[[	##########################################################################	##                                                                      ##	## Project: 'MTA Alan Wake' - Gamemode for Multi Theft Auto San Andreas ##	##                      Developer: Noneatme                             ##	##           License: See LICENSE in the top level directory            ##	##                                                                      ##	##########################################################################]]local cFunc = {}local cSetting = {}-- FUNCTIONS --cSetting["interactCol"] = createColSphere(0, 0, 0, 3)cSetting["interactElement"] = niladdEventHandler("onClientColShapeHit", cSetting["interactCol"], function(hitElement)	if(getElementType(hitElement) == "ped") then	--	local ped = getNearestPedToPlayer(localPlayer)		if(getElementData(hitElement, "ped:name")) then			cSetting["interactElement"] = hitElement			setElementData(localPlayer, "interactElement", hitElement, false)			setElementData(localPlayer, "specialAction", true, false)			playSound("data/sounds/mission_scrollover.mp3", false)		end	elseif(getElementType(hitElement) == "vehicle") then		cSetting["interactElement"] = hitElement		setElementData(localPlayer, "interactElement", hitElement, false)		setElementData(localPlayer, "specialAction", true, false)		playSound("data/sounds/mission_scrollover.mp3", false)	elseif(getElementType(hitElement) == "object") and (getElementData(hitElement, "triggerable")) then		cSetting["interactElement"] = hitElement		setElementData(localPlayer, "interactElement", hitElement, false)		setElementData(localPlayer, "specialAction", true, false)		playSound("data/sounds/mission_scrollover.mp3", false)	endend)addEventHandler("onClientColShapeLeave", cSetting["interactCol"], function(hitElement)	if(cSetting["interactElement"] == hitElement) then		cSetting["interactElement"] = nil		setElementData(localPlayer, "specialAction", false, false)	endend)-- RENDER --cFunc["renderInteract"] = function()	local he = cSetting["interactElement"]	if(isElement(cSetting["interactElement"])) and (isPedInVehicle(localPlayer) == false) then		local x, y, z = getElementPosition(cSetting["interactElement"])		if(getElementType(cSetting["interactElement"]) == "vehicle") then			z = z+0.5+getElementDistanceFromCentreOfMassToBaseOfModel(cSetting["interactElement"])		end		if(getElementType(cSetting["interactElement"]) == "ped") then			z = z+1		end		local sx, sy = getScreenFromWorldPosition(x, y, z, 500)		local r, g, b = 255, 255, 255		if(sx) and (sy) then			sx = sx+100			local x2, y2, z2 = getElementPosition(localPlayer)			local dis = getDistanceBetweenPoints3D(x, y, z, x2, y2, z2)			-- RECTANGLE --			dxDrawRectangle(sx-70, sy, 100-(dis*10), 130-(dis*10), tocolor(0, 0, 0, 100))			dxDrawImage(sx-70, sy, 100-(dis*10), 130-(dis*10), "data/images/rahmen.png", 0, 0, 0, tocolor(255, 255, 255, 255))			-- Strich --						dxDrawRectangle(sx-70, sy+20, 100-(dis*10), 1, tocolor(0, 0, 0, 250))			-- TEXT --			local titel, beschreibung = "", ""			if(getElementType(he) == "ped") then				titel = getElementData(he, "ped:name")				beschreibung = "Press 'E' to\ntalk"			elseif(getElementType(he) == "vehicle") then				titel = "Vehicle"				if(isVehicleLocked(he) == true) then					beschreibung = "Not\ndriveable"				else					beschreibung = "Driveable"					r, g, b = 0, 255, 255				end			elseif(getElementType(he) == "object") then				titel = "Object"				beschreibung = getElementData(he, "description")				r, g, b = 255, 255, 0			end			local scale = 2/dis			if(scale > 1) then scale = 1 end			-- MISSION THING --			local mission = tonumber(getElementData(localPlayer, "mission"))			if(titel == "Barkeeperin") and (mission == 2) then				r, g, b = 0, 255, 255			elseif(titel == "Mr.Fleischberg") and (mission == 4) then				r, g, b = 0, 255, 255			end			dxDrawText(titel, sx-60, sy+2, 100-(dis*10), 100-(dis*10), tocolor(r, g, b, 200), scale, "default-bold", "left", "top", false, true)			dxDrawText(beschreibung, sx-60, sy+50, 100-(dis*10), 130-(dis*10), tocolor(255, 255, 255, 200), scale, "default-bold", "left", "top", false, true)		end	endendaddEventHandler("onClientRender", getRootElement(), cFunc["renderInteract"])-- EVENT HANDLERS --cFunc["keepColAtPlayer"] = function()	setElementInterior(cSetting["interactCol"], getElementInterior(localPlayer))	setElementDimension(cSetting["interactCol"], getElementDimension(localPlayer))	local x, y, z = getElementPosition(localPlayer)	setElementPosition(cSetting["interactCol"], x, y, z)endsetTimer(cFunc["keepColAtPlayer"], 50, 0)function getNearestPedToPlayer(player)	local vehicle	local minDis = math.huge	local x, y, z = getElementPosition(player)	local dis	for k, v in pairs(getElementsByType("ped")) do		dis = getDistanceBetweenPoints3D(x, y, z, getElementPosition(v))		if dis < minDis then			vehicle = v			minDis = dis		end	end		return vehicleend